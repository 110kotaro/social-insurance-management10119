<div class="password-setup-container">
  <div class="password-setup-card">
    <h1>パスワード設定</h1>
    
    <div *ngIf="isValidatingCode" class="validating">
      <p>リンクを確認中...</p>
    </div>

    <div *ngIf="!isValidatingCode && email" class="setup-form">
      <p class="email-info">
        <strong>{{ email }}</strong> のパスワードを設定してください。
      </p>

      <form [formGroup]="passwordForm" (ngSubmit)="onSubmit()">
        <div class="form-field">
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>新しいパスワード</mat-label>
            <input 
              matInput 
              type="password" 
              formControlName="password" 
              required
              [class.error]="password?.invalid && password?.touched">
            <mat-icon matPrefix>lock</mat-icon>
            <mat-error *ngIf="password?.hasError('required')">
              パスワードを入力してください
            </mat-error>
            <mat-error *ngIf="password?.hasError('minlength')">
              パスワードは6文字以上で入力してください
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-field">
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>パスワード（確認）</mat-label>
            <input 
              matInput 
              type="password" 
              formControlName="confirmPassword" 
              required
              [class.error]="confirmPassword?.invalid && confirmPassword?.touched">
            <mat-icon matPrefix>lock_outline</mat-icon>
            <mat-error *ngIf="confirmPassword?.hasError('required')">
              パスワード（確認）を入力してください
            </mat-error>
            <mat-error *ngIf="passwordForm.hasError('passwordMismatch') && confirmPassword?.touched">
              パスワードが一致しません
            </mat-error>
          </mat-form-field>
        </div>

        <div class="actions">
          <button 
            type="submit" 
            class="btn-primary" 
            [disabled]="passwordForm.invalid || isLoading">
            <mat-icon *ngIf="isLoading">hourglass_empty</mat-icon>
            {{ isLoading ? '設定中...' : 'パスワードを設定' }}
          </button>
        </div>
      </form>
    </div>

    <div *ngIf="!isValidatingCode && !email" class="error-message">
      <p>無効なリンクです。</p>
      <p>ログイン画面に戻ります...</p>
    </div>
  </div>
</div>

